# Homework 15 — Kubernetes
**Author: M. Yang**

## Question 1
> K8s Infrastructure

![kubernetes-cluster-architecture](https://kubernetes.io/images/docs/kubernetes-cluster-architecture.svg)

### Control Plane (Master Nodes)

#### ◆ API Server
Services **REST operations** and provides the **frontend** to the cluster's shared state through which **all other components interact**.

#### ◆ etcd
A **distributed**, consistent **key-value store** to store all cluster **configuration** and **state** data.
`etcd` ≈ `/etc` for `d`istributed systems.

Stores [**API Objects**](#question-2) (**YAML**/JSON):
- Ingresses
- Namespaces
- Deployments
- ReplicaSets
- Pods
- Services
- PVCs
- PVs
- Secret
- ConfigMap

#### ◆ Controller Manager
Runs background controllers to **watch** cluster state and make changes to **maintain** the desired configuration.

Watches:
- Namespace creation/deletion
- Deployments → creates ReplicaSets
- ReplicaSets → creates Pods
- PVCs → binds to PVs

#### ◆ Scheduler
**Assigns** newly created **pods to nodes** based on resource availability, policies, and constraints to ensure **optimal workload** placement.


### Worker Nodes

#### ◆ Kubelet
An **agent** that **communicates** with the **API server**, and **ensures** that the **containers** described in PodSpecs (received from the API server) are **running** and remain healthy.

#### ◆ Container Runtime
The software responsible for running containers (e.g., **Docker**).

Kubelet talks to the container runtime through the container runtime interface (**CRI**). A container runtime must implement CRI to work with Kubernetes.

#### ◆ Kube-proxy
Manages **network rules** on each node and handles **internal routing** between services and pods, providing basic **load balancing**.


## Question 2
> K8s Primitives

| **Component**           | **Type**                                  | **Description**                                                                                                      |
|-------------------------|-------------------------------------------|----------------------------------------------------------------------------------------------------------------------|
| Namespace               | API Object                                | Isolates resources **logically** (e.g., by service, by dev/test/prod)                                                |
| Ingress                 | API Object                                | Defines **external HTTP/HTTPS routing rules**                                                                        |
| Ingress Controller      | Deployment (**Pod/Pods** on Worker Nodes) | Listens to `Ingress` resources and sets up **routing/load-balancing** (e.g., Nginx), **installation needed**         |
| Service                 | API Object                                | Exposes a **group of pods** via networking (e.g., LoadBalancer, NodePort, ClusterIP)                                 |
| Deployment              | API Object                                | Manages **stateless** application pods (i.e., app does not store data locally; safe to restart or scale)             |
| ReplicaSet              | API Object                                | Ensures a certain number of **pod replicas**                                                                         |
| Pod                     | API Object                                | **Smallest deployable unit**, defines a container or group of containers (e.g., app container & side-car containers) |
| Persistent Volume Claim | API Object                                | **User’s request** for storage (e.g., required size, access mode, storage class)                                     |
| Persistent Volume       | API Object                                | Defines storage resource in the cluster (e.g., capacity, access mode, reclaim policy, storage class, volume handle)  |
| Secret                  | API Object                                | Stores sensitive data (e.g., JWT secret key)                                                                         |
| ConfigMap               | API Object                                | Stores non-sensitive app config data (e.g., `application.properties`)                                                |
| Container Registry      | External System                           | Where the kubelet pulls container images from (e.g., **Docker Hub**)                                                 |


## Question 3
> Service Type:
> - ClusterIP
> - NodePort
> - LoadBalancer

| **Service Type**  | **ClusterIP**                                                                  | **NodePort**                                                 | **LoadBalancer**                                                            |
|-------------------|--------------------------------------------------------------------------------|--------------------------------------------------------------|-----------------------------------------------------------------------------|
| **Accessibility** | Internal to cluster only                                                       | External via **NodeIP:NodePort** (LAN/VPC)                   | External via **PublicIP** (Internet or VPC)                                 |
| **Routing**       | ClusterIP:port (or **ServiceName**:port)<br>→ kube-proxy<br>→ PodIP:targetPort | NodeIP:nodePort<br>→ kube-proxy<br>→ ClusterIP:port<br>→ ... | PublicIP:80 (or 443)<br>→ Cloud Load Balancer<br>→ NodeIP:nodePort<br>→ ... |
| **Use Case**      | Internal communication between **pods/services**                               | Simple external access (**dev/test**)                        | Production-ready external access                                            |
| **Notes**         | **Default** service type, **virtual** IP & port                                | **Static** `nodePort` on **each node** (30000–32767)         | Requires **external cloud LB** (e.g., AWS ELB)                              |


## Question 4
> Ways to Expose Services

| **Method** | **NodePort**                             | **LoadBalancer**                   | **Ingress**                         |
|------------|------------------------------------------|------------------------------------|-------------------------------------|
| **Notes**  | External clients on the **same network** | 1 service : 1 **public** IP/domain | N services : 1 **public** IP/domain |

### Load Balancer

### Ingress